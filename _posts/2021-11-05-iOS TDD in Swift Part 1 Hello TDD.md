---
title:  "iOS TDD in Swift Part 1 Hello TDD" 
toc: true
---

---

æˆ‘åœ¨å¼€å‘ä¸­ï¼Œé‡åˆ°çš„ä¸¤ç§å¥‡æ€ªç°è±¡ï¼š

- ä¸ºäº†å°½å¿«ææµ‹ï¼Œç»å¸¸ææµ‹åæ‰å¼€å§‹å†™ Unit Test Case (åè¾¹ç®€ç§° UT)ï¼Œ QA å’Œ UT å‡ ä¹åŒæ—¶è¿›è¡Œã€‚åœ¨å†™ UT æ—¶å‘ç°è‡ªå·±ç»´æŠ¤çš„ç±»é‡Œå‡ºç°äº†ä¹±ç ä¸ƒç³Ÿçš„ä»£ç ï¼ˆå®é™…æ›´ç³Ÿç³•ï¼‰ï¼Œéœ€è¦é‡æ–°è°ƒæ•´ä½ç½®ï¼Œè¿™ç§æ“ä½œå¯èƒ½ä¼šå¼•èµ·é€»è¾‘æ”¹åŠ¨ï¼Œå¯¼è‡´äº†éœ€è¦å›æµ‹ï¼Œæµªè´¹äº†å¼€å‘å’Œæµ‹è¯•æ›´å¤šçš„æ—¶é—´ï¼Œä¸ºäº†æå‰é‚£å‡ å¤©ææµ‹ï¼Œæ•´ä½“èŠ±è´¹çš„æ—¶é—´å¯èƒ½æ›´å¤šã€‚
- ä¸åŠæ—¶æ›´æ–° UT çš„é—®é¢˜ï¼Œå½“å†™å®Œéœ€æ±‚å†å»å†™ UTï¼Œå½“æ—¶æ˜¯é€šè¿‡çš„ï¼Œä½†éšç€éœ€æ±‚è¿­ä»£ï¼Œæœ‰äººåœ¨å‡½æ•°é‡ŒåŠ äº†ä¸å½±å“ UT çš„ä»£ç ï¼Œç”±äºä¸å¼ºåˆ¶åœ¨å†™ä»£ç å‰å†™å¥½ Test Caseï¼Œæ—¶é—´ä¹…äº†å°±ä¼šå‡ºç° UT æ— æ³•ä½¿ç”¨çš„æƒ…å†µã€‚

Test-driven development(åè¾¹ç®€ç§° TDD) æ­£å¥½èƒ½è§£å†³ä¸Šè¾¹ä¸¤ä¸ªç°è±¡ï¼Œé‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•é¿å…çš„å‘¢ï¼Œé€šè¿‡è¿™ç¯‡æ¥è®²ä¸€ä¸‹ TDD å’Œå¾ªç¯ï¼Œç”¨ä¸€ä¸ªå°çš„å®è·µæ¥æ¼”ç¤º TDD å¼€å‘ã€‚

### 1. TDD

#### 1.1 TDD æ˜¯ä»€ä¹ˆ

TDD æ˜¯ä¸€ç§é€šè¿‡è¿­ä»£åœ°è¿›è¡Œè®¸å¤šç”±æ”¯æŒæµ‹è¯•çš„å°å˜æ›´æ¥å¼€å‘è½¯ä»¶çš„è¿­ä»£æ–¹å¼ã€‚è¿™ä¸ªæ˜¯ TDD å¾ªç¯

<img src="https://assets.alexandria.raywenderlich.com/books/itdd/images/1fd7eb6808587a2d64b149794f3228d347d9d62c10d15dba04ce068afce474aa/original.png" alt="img" style="zoom: 25%;" />

TDD å¾ªç¯åˆ†ä¸ºå››æ­¥:

1. å†™ä¸€ä¸ªä¼šå¤±è´¥çš„ testã€‚
2. ç¼–å†™ä»£ç è®©è¿™ä¸ª test é€šè¿‡ã€‚
3. é‡æ„ã€‚
4. é‡å¤ã€‚

ä½ çš„ä»£ç æ˜¯è¢« test é©±åŠ¨å‡ºæ¥çš„ï¼Œæ‰€ä»¥ TDD èƒ½å½»åº•å¹¶ç²¾ç¡®åœ°æµ‹è¯•ä½ çš„ä»£ç ã€‚TDD ä¼¼ä¹éå¸¸ç®€å•ï¼Œå®é™…ä¹Ÿæ˜¯å¦‚æ­¤ã€‚

#### 1.2 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ TDDï¼Œä¸ºä»€ä¹ˆè¦å†™ UT

TDD æ˜¯ç¡®ä¿ä½ çš„ä»£ç æ‰§è¡ŒæˆåŠŸå’Œå°†æ¥æ‰§è¡Œä¾ç„¶æˆåŠŸæœ€å¥½çš„æ–¹å¼ã€‚ä½ å¯èƒ½è®¤ä¸ºä¸ä½¿ç”¨ TDDï¼Œä¸å†™ UTï¼Œä½ ä¹Ÿèƒ½å†™å‡ºèƒ½å¤Ÿä¸Šçº¿çš„ä»£ç ã€‚å½“ç„¶å¯ä»¥ï¼ŒçŸ­æœŸå¾ˆå®¹æ˜“åšåˆ°ï¼Œä½†æ˜¯é•¿æœŸä¸‹æ¥ï¼Œé€»è¾‘é€æ¸å¤æ‚ï¼Œä¿®æ”¹ bug è¦é˜…è¯»çš„ä»£ç æ¶ˆè€—çš„æ—¶é—´å°†æŒ‡æ•°å¢é•¿ã€‚å½“ç„¶å¤§ç¯å¢ƒéƒ½æ˜¯é¡¹ç›®æ’æœŸç´§ï¼Œå¾ˆéš¾æœ‰æ—¶é—´å†™ UTï¼Œæ›´åˆ«è¯´ TDD äº†ï¼Œæœ€ç»ˆè¿˜æ˜¯çœ‹ä½ æ˜¯é¢å‘ä¿¡ä»°ç¼–ç¨‹è¿˜æ˜¯é¢å‘è€æ¿ç¼–ç¨‹äº†ã€‚

ä½ å¯ä»¥å®Œæˆä¸šåŠ¡å¼€å‘åå†å†™ UTï¼Œæˆ–è€…ç›´æ¥æ‰‹åŠ¨æµ‹è¯•ä½ çš„ä»£ç ã€‚é‚£ä¸ºä»€ä¹ˆ TDD æ¯”å…¶ä»–çš„æ–¹å¼å¥½ï¼Ÿ

å¥½çš„ test èƒ½ä¿è¯ä½ çš„ App æŒ‰ç…§æœŸæœ›è¿è¡Œï¼Œç„¶è€Œä¸æ˜¯æ‰€æœ‰çš„ Test éƒ½æ˜¯"å¥½çš„"ã€‚å¥½çš„ test åº”è¯¥æ˜¯å¯å¤±è´¥çš„ã€å¯é‡å¤çš„ã€å¿«é€Ÿè¿è¡Œçš„å’Œå¯ç»´æŠ¤çš„ã€‚TDD æä¾›äº†æ–¹æ³•æ¥ç¡®ä¿ä½ çš„ test æ˜¯å¥½çš„ï¼š

- ç¬¬ä¸€æ­¥å°±æ˜¯å†™ä¸€ä¸ªä¼šå¤±è´¥çš„ testï¼Œä¸å¤±è´¥çš„ Test åªæ˜¯åœ¨æµªè´¹ CPUã€‚
- å½“ä½ æ–°çš„ test é€šè¿‡æ—¶ï¼Œéœ€è¦ç¡®ä¿æ‰€æœ‰ä¹‹å‰çš„ tests éƒ½èƒ½é€šè¿‡ï¼Œè¿™å°±ç¡®ä¿ä½ çš„ tests æ˜¯å¯é‡å¤çš„ã€‚ä½ ä¸èƒ½åªæ‰§è¡Œä½ æ­£åœ¨å¼€å‘çš„ testï¼Œå»ºè®®æ‰§è¡Œå…¨éƒ¨ testsã€‚
- ç”±äºè¦ç»å¸¸æ‰§è¡Œæ‰€æœ‰çš„ testsï¼Œæ‰€ä»¥è¦ç¡®ä¿ test æ˜¯å¿«é€Ÿæ‰§è¡Œçš„ï¼Œå¦‚æœå¤ªä¹…ï¼Œå°±æ²¡äººä¼šæ‰§è¡Œæ‰€æœ‰çš„ testsã€‚
- å½“ä½ åœ¨é‡æ„æ—¶ï¼Œä½ éœ€è¦åŒæ—¶æ›´æ–°äº†ç”Ÿäº§ä»£ç å’Œæµ‹è¯•ä»£ç ï¼Œä½ éœ€è¦ä¸æ–­åœ°ä¿æŒå®ƒä»¬åˆ°æœ€æ–°ã€‚
- éšç€ä»£ç çš„è¿­ä»£ï¼Œä½ éœ€è¦ç¡®ä¿ä½ çš„ä»£ç æ˜¯å¯æµ‹è¯•çš„ã€‚å¦‚æœåœ¨å¼€å‘åå†å†™ UTï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå› æ­¤åšä¸€äº›é‡æ„æ¥è®© test è¦†ç›–ã€‚

ä½ ä¼šä½¿ç”¨ä¸€äº›æ–¹æ³•æ¥ç¡®ä¿ä½ åœ¨å†™å¥½çš„ testï¼Œä½ ä¼šå‘ç°ä½ å°±åœ¨åš TDDï¼

#### 1.3 åº”è¯¥ä¸ºå“ªäº›ä»£ç å†™ Test

æ›´é«˜çš„æµ‹è¯•è¦†ç›–ç‡ä¸ä»£è¡¨ä½ çš„ App æ­£åœ¨è¢«æ›´å¥½çš„æµ‹è¯•ï¼Œä¸‹è¾¹æ˜¯ä¸€äº›å»ºè®®ï¼š

- å»ºè®®ä¸ºè‡ªåŠ¨åŒ–ä¸èƒ½æ•è·çš„ä»£ç å†™ testï¼Œæ¯”å¦‚ä½ è‡ªå®šä¹‰ç±»é‡Œçš„å‡½æ•°å’Œå¤§å¤šæ•°ä½ è‡ªå·±å†™çš„ä»£ç ã€‚
- ä¸å»ºè®®ä¸ºç”Ÿæˆå‡ºçš„ä»£ç å†™ testï¼Œæ¯”å¦‚ç”Ÿæˆå‡º getters å’Œ settersï¼Œä½ å¯ä»¥ç›¸ä¿¡å®ƒèƒ½æ­£å¸¸ workã€‚
- ä¸å»ºè®®ä¸ºç¼–è¯‘å™¨èƒ½æ•è·çš„é—®é¢˜æ¥å†™ testã€‚
- ä¸å»ºè®®ä¸ºåŸºç¡€åº“æˆ–ç¬¬ä¸‰æ–¹åº“å†™ testï¼Œåº“çš„ä½œè€…åº”è¯¥ä¸ºè¿™äº›æ¥å£å’Œå±æ€§å†™ testï¼Œä¸¾ä¸ªğŸŒ°ï¼Œä½ ä¸éœ€è¦ä¸º UIKit çš„ç±»æ¥å†™ testsï¼Œç„¶è€Œä½ éœ€è¦ä¸ºä½ ç»§æ‰¿çš„å­ç±»å†™ testsã€‚è¿™äº›æ˜¯ä½ è‡ªå®šä¹‰å‡ºæ¥çš„ä»£ç ï¼Œæ‰€ä»¥ä½ åº”è¯¥å†™å¯¹åº”çš„ testsã€‚

æœ‰ä¸¤ä¸ªç‰¹æ®Šæƒ…å†µï¼Œä¸€ç§æ˜¯ä½ æƒ³çŸ¥é“ä¸€ä¸ª framework æ˜¯å¦‚ä½• workï¼Œé‚£ä¹ˆå†™ä¸€äº› tests æ˜¯æœ‰å¸®åŠ©çš„ï¼Œä½†æ˜¯è¿™äº› tests ä¸ä¼šæŒç»­å¾ˆä¹…ã€‚å¦ä¸€ç§æ˜¯ç¬¬ä¸‰æ–¹çš„ä»£ç éå¸¸ä¸ç¨³å®šï¼Œæ‰€ä»¥éœ€è¦å†™ tests æ¥ç¡®ä¿ï¼Œé‚£ä¹ˆä½ è¯¥è€ƒè™‘è¦ä¸è¦ç»§ç»­ä½¿ç”¨è¿™ä¸ªåº“äº†ã€‚

##### TDD èŠ±è´¹å¤ªå¤šæ—¶é—´ï¼

è¿™æ˜¯æœ€å¸¸è§çš„æŠ±æ€¨äº†ã€‚ç„¶è€Œå½“ä½ ä¹ æƒ¯ä½¿ç”¨ TDD æ¥å¼€å‘åä¼šæ¯”æ ¹æœ¬ä¸å†™ tests æ›´å¿«ï¼Œå› ä¸ºåœ¨åè€…æƒ…å†µä¸‹ä½ æœ€ç»ˆå†™äº†æ›´å¤šçš„ä»£ç ã€‚

å€¼å¾—è®¨è®ºçš„é—®é¢˜æ˜¯ï¼šå¼€å‘èŠ±è´¹çš„çœŸå®æ—¶é—´ï¼ä»–ä¸æ­¢æ˜¯å†™ä¸€ä¸ªç‰ˆæœ¬ï¼Œä¹ŸåŒ…æ‹¬åè¾¹çš„æ–°éœ€æ±‚ï¼Œå˜æ›´ä»£ç ï¼Œä¿®å¤ bugs ç­‰ç­‰ï¼Œåœ¨è¿™ä¸ªé•¿è·‘è¿‡ç¨‹ä¸­ï¼Œç›¸æ¯”äºæ²¡æœ‰ TDD ï¼ŒTDD èŠ±è´¹äº†æ›´å°‘çš„æ—¶é—´ï¼Œå› ä¸ºå®ƒç”Ÿäº§æ›´ç›¸å…³çš„ä»£ç ï¼Œå¸¦æ¥æ›´å°‘çš„ bugsã€‚

å¦ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼šçº¿ä¸Š bug çš„å½±å“ã€‚å¦‚æœ bug æ˜¯å¼€å‘è¿‡ç¨‹ä¸­å‘ç°ï¼Œä¼šéå¸¸å®¹æ˜“ä¿®å¤ï¼Œä½†æ˜¯å¦‚æœè¿‡äº†å‡ å‘¨æ‰å‘ç°ï¼Œä½ ä¼šèŠ±è´¹æ›´å¤šæ—¶é—´ debg ä»£ç æ¥å¯»æ‰¾æ ¹æœ¬åŸå› ï¼Œä½ çš„ tests ä¼šå¸®åŠ©ä½ å¯¹æŠ—è¿™ç§æƒ…å†µã€‚

#### 1.4 ä»€ä¹ˆæ—¶é—´å¼€å§‹ä½¿ç”¨ TDD

å¦‚æœä½ çš„ App è¦å‘å¸ƒå¹¶æŒç»­è¿­ä»£ï¼ŒåŒæ—¶/æˆ–è€…ä½ çš„å·¥ç¨‹æœ‰å¤æ‚é€»è¾‘ï¼Œä½ æœ€å¥½åŠæ—¶ä½¿ç”¨ TDDã€‚

å¦‚æœä½ åªæ˜¯ç”¨æ¥å†™ä¸€ä¸ª demo å·¥ç¨‹æˆ–è€…ä¸´æ—¶çš„å·¥ç¨‹ï¼Œ é‚£ä¹ˆä½ éšæ„ã€‚

æ€»ä¹‹ï¼ŒTDD æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œä½ è‡ªå·±æ¥å†³å®šä»€ä¹ˆæ—¶å€™æ¥ä½¿ç”¨å®ƒã€‚

#### 1.5 å…³é”®ç‚¹

ä½ åº”è¯¥äº†è§£äº† TDD æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆä½¿ç”¨å®ƒï¼Œå“ªäº›ä»£ç åº”è¯¥è¢«æµ‹è¯•å’Œä»€ä¹ˆæ—¶é—´å»ä½¿ç”¨å®ƒã€‚

- TDD æå¤Ÿäº†å†™å¥½çš„ tests çš„æ–¹å¼ã€‚
- å¥½çš„ test æ˜¯å¯å¤±è´¥çš„ã€å¯é‡å¤çš„ã€å¿«é€Ÿè¿è¡Œçš„å’Œå¯ç»´æŠ¤çš„ã€‚
- å¼€å‘çœŸæ­£çš„æ—¶é—´èŠ±è´¹åŒ…å«åˆå§‹å¼€å‘ï¼Œæ·»åŠ æ–°éœ€æ±‚ï¼Œä¿®æ”¹ç°æœ‰é€»è¾‘å’Œä¿®å¤ bugs ç­‰ç­‰ã€‚TDD å‡å°‘ç»´æŠ¤æˆæœ¬å’Œä¿è¯äº† bugs çš„å¯æ§
- TDD å¯¹äºä¸€ä¸ªé•¿æœŸçš„é¡¹ç›®æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚

### 2. TDD å¾ªç¯

#### 2.1 å‡†å¤‡

åœ¨è¿™ä¸ªå°èŠ‚ï¼Œä½ è®²ç»§ç»­å…³æ³¨äº TDD ï¼Œä½ å¯ä»¥ä½¿ç”¨ playgroundï¼Œåˆ›å»ºä¸€ä¸ª **CashRegister.playground** ã€‚"File" -> "New" -> "Playground"ï¼Œ é€‰æ‹© "Blank"ã€‚

![image-20211110182716628](https://github.com/zhaoxiangyulove/zhaoxiangyulove.github.io/blob/main/assets/pic/image-20211110182716628.png?raw=true)

åˆ æ‰æ‰€æœ‰çš„ä»£ç ï¼Œå¼€å§‹ä½¿ç”¨ TDDã€‚

#### 2.2 çº¢è‰²

åœ¨ä½ å†™ç”Ÿäº§ä»£ç å‰ï¼Œä½ éœ€è¦å†™ä¸€ä¸ªä¼šå¤±è´¥çš„ testã€‚

é¦–å…ˆä½ éœ€è¦å»ºä¸€ä¸ª testCase çš„ç±»ï¼Œå¤åˆ¶ä¸‹è¾¹çš„ä»£ç åˆ° playgroundã€‚

```swift
import XCTest

class CashRegisterTests: XCTestCase {

}
```

ç¼–è¯‘ï¼Œå¦‚æœæŠ¥é”™ **error: unable to load standard library for target 'arm64-apple-macos11.0'** éœ€è¦å°† platform è®¾ç½®ä¸º macOSï¼Œè¿è¡Œé€šè¿‡ã€‚

æ¥ä¸‹æ¥åœ¨ playground æœ€ä¸‹æ–¹æ·»åŠ 

```swift
CashRegisterTests.defaultTestSuite.run()
```

è¿™æ˜¯è®© playground å»è·‘ <hl>CashRegisterTests</hl> ä¸‹æ‰€æœ‰çš„ testsï¼Œç„¶è€Œè¿˜æ²¡æœ‰ä»»ä½• testsï¼Œæ‰€ä»¥åœ¨é‡Œè¾¹æ·»åŠ ä¸€ä¸ªä¼šå¼•èµ·ç¼–è¯‘æŠ¥é”™çš„ testã€‚

```swift
// 1
func testInit_createsCashRegister() {
  // 2
  XCTAssertNotNil(CashRegister())
}

```

1. è§£é‡Šä¸‹å‡½æ•°å‘½åï¼š

- XCTestï¼šéœ€è¦æ‰€æœ‰çš„æµ‹è¯•å‡½æ•°ä»¥ <hl>test</hl> å¼€å¤´ã€‚
- testï¼šæ¥ä¸‹æ¥æ˜¯å‡½æ•°è¦æµ‹è¯•çš„åå­—ï¼Œè¿™é‡Œæ˜¯ <hl>init</hl>ï¼Œç”¨ "_"å’Œä¸‹ä¸ªéƒ¨åˆ†åŒºåˆ†ã€‚
- æœ€åçš„éƒ¨åˆ†æ˜¯æœŸæœ›çš„è¾“å‡ºæˆ–ç»“æœï¼Œè¿™é‡Œæ˜¯ <hl>createsCashRegister</hl> ã€‚

è¿™ç§å‘½åå®¹æ˜“ç†è§£åŒæ—¶æä¾›æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå¦‚æœ test å¤±è´¥äº†ï¼ŒXcode ä¼šå‘Šè¯‰ä½  test çš„ç±»å’Œå‡½æ•°åï¼Œé€šè¿‡è¿™ç§å‘½åæ–¹å¼å¯ä»¥å¿«é€Ÿäº†è§£é—®é¢˜ã€‚

2. ä½ è¯•å›¾åˆå§‹åŒ–ä¸€ä¸ª<hl>CashRegister</hl> çš„å®ä¾‹ã€‚é€šè¿‡ <hl>XCTAssertNotNil</hl> è¡¨è¾¾å¼æ¥åˆ¤æ–­ï¼Œå½“å‚æ•°ä¸ä¸º nil åˆ™é€šè¿‡ã€‚

![WX20211110-185352](https://github.com/zhaoxiangyulove/zhaoxiangyulove.github.io/blob/main/assets/pic/WX20211110-185352.png?raw=true)

ç„¶è€Œï¼Œç¬¬ä¸ƒè¡Œå¹¶ä¸èƒ½ç¼–è¯‘ï¼Œå› ä¸ºä½ è¿˜æ²¡æœ‰åˆ›å»º<hl>CashRegister</hl> çš„ç±»ï¼Œåœ¨ TDD é‡Œæœ‰è¿™æ ·ä¸€æ¡è§„åˆ™ï¼Œç¼–è¯‘å¤±è´¥è§†ä¸º test å¤±è´¥ï¼Œæ‰€ä»¥ä½ å·²ç»å®Œæˆäº† TDD å¾ªç¯çš„ç¬¬ä¸€æ­¥ã€‚

#### 2.3 ç»¿è‰²

TDD ä¸­ä½ åªèƒ½å†™æœ€å°‘çš„ä»£ç è®©è¿™ä¸ª test é€šè¿‡ï¼Œå¦‚æœä½ å†™äº†æ¯”ä¸‹è¾¹çš„ä»£ç æ›´å¤šï¼Œä½ çš„ test å°†ä¼šè½åäºä½ çš„ç”Ÿäº§ä»£ç ï¼é‚£æœ€å°‘çš„ä»£ç èƒ½è§£å†³ä¸Šè¾¹çš„ç¼–è¯‘é—®é¢˜çš„ä»£ç æ˜¯ä»€ä¹ˆï¼Ÿå£°æ˜ä¸€ä¸ª<hl>CashRegister</hl>ç±»ã€‚

åœ¨<hl>CashRegisterTest</hl>ä¸Šæ–¹æ·»åŠ ä¸‹é¢çš„ä»£ç ï¼š

```swift
class CashRegister {
  
}
```

ç‚¹å‡»æ‰§è¡Œï¼Œä½ ä¼šçœ‹åˆ°æ§åˆ¶å°è¾“å‡ºï¼š

```swift
Test Suite 'CashRegisterTests' started at 2021-11-10 22:20:45.074
Test Case '-[__lldb_expr_18.CashRegisterTests testInit_createsCashRegister]' started.
Test Case '-[__lldb_expr_18.CashRegisterTests testInit_createsCashRegister]' passed (0.003 seconds).
Test Suite 'CashRegisterTests' passed at 2021-11-10 22:20:45.078.
	 Executed 1 test, with 0 failures (0 unexpected) in 0.003 (0.004) seconds
```

å¥½è€¶ï¼ä½ å·²ç»è®© test é€šè¿‡äº†ï¼Œä¸‹ä¸€æ­¥ï¼Œé‡æ„ä½ çš„ä»£ç ã€‚

#### 2.4 é‡æ„

ä½ å°†ä¼šåœ¨é‡æ„è¿™ä¸€æ­¥åŒæ—¶æ¸…ç†ä½ çš„ç”Ÿäº§ä»£ç å’Œæµ‹è¯•ä»£ç ï¼Œè¿™æ ·ä½ èƒ½ç»´æŒå®ƒä»¬ä¹‹é—´çš„è”ç³»ï¼ŒåŒæ—¶æå‡ä½ çš„ä»£ç ï¼Œè¿™é‡Œæœ‰å‡ ä»¶äº‹å¯ä»¥å»é‡æ„ã€‚

- é‡å¤çš„é€»è¾‘ã€‚
- ä¸€äº›æ— ç”¨çš„æ³¨é‡Šã€‚è¿™é‡Œè§£é‡Šä¸‹ï¼Œä½ çš„æ³¨é‡Šåº”è¯¥å»è§£é‡Šä¸ºä»€ä¹ˆä¼šå†™ä¸‹è¾¹çš„ä»£ç ï¼Œè€Œä¸æ˜¯ä¸‹è¾¹çš„ä»£ç åšäº†ä»€ä¹ˆã€‚åè€…æ›´åº”è¯¥å»æ‹†åˆ†ä¸ºå‡ ä¸ªåˆç†çš„å‡½æ•°ã€‚ã€‚
- ä»£ç åå‘³é“ã€‚ã€Šé‡æ„ æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡ã€‹ç¬¬ä¸‰ç« ï¼Œæœ‰è¯¦ç»†çš„ä»‹ç»ï¼Œæœ‰å…´è¶£å¯ä»¥å»è¯»ä¸€è¯»ã€‚

ç›®å‰ï¼Œ<hl>CashRegister</hl> å’Œ <hl>CashRegisterTests</hl> è¿˜æ²¡æœ‰å¾ˆå¤šä»£ç ï¼Œæ‰€ä»¥æ— éœ€é‡æ„ï¼Œæ‰€ä»¥è¿™ä¸€æ­¥å·²ç»å®Œæˆäº†ã€‚æ¥ä¸‹æ¥æ˜¯æœ€é‡è¦çš„ä¸€æ­¥ï¼šé‡å¤ã€‚

#### 2.5 é‡å¤

è¿™ä¸€æ­¥æ˜¯ TDD å¾ªç¯ä¸­å—ç›Šæœ€å¤§çš„ä¸€æ­¥ã€‚ä½ å°†åœ¨æ¯ä¸ª TDD å¾ªç¯å®Œæˆä¸€éƒ¨åˆ†åŠŸèƒ½ï¼Œé€šè¿‡æµ‹è¯•ç”¨ä¾‹æ¥é©±åŠ¨å®ç°é€»è¾‘ã€‚å½“ä½ å®Œæˆæ‰€æœ‰çš„éœ€æ±‚æ—¶ï¼Œä½ çš„ UT ä¹Ÿæ˜¯å®Œæ•´çš„ã€‚

ä½ å·²ç»å®Œæˆäº†ç¬¬ä¸€ä¸ª TDD å¾ªç¯ï¼Œä½ æœ‰ä¸€ä¸ªå¯ä»¥åˆå§‹åŒ–çš„ <hl>CashRegister</hl> ç±»ï¼Œè¿™ä¸ªç±»å¯ä»¥æ·»åŠ ä¸€äº›æœ‰ç”¨çš„å‡½æ•°ã€‚ä¸‹è¾¹æ˜¯ä¸€äº› todoï¼š

- æ·»åŠ åˆå§‹åŒ–å‡½æ•°æ¥å— <hl>availableFunds</hl>ã€‚
- æ·»åŠ  <hl>addItem</hl> å‡½æ•°ï¼Œç”¨æ¥æ·»åŠ äº¤æ˜“ã€‚
- æ·»åŠ <hl>acceptPayment</hl> å‡½æ•°ã€‚

##### TDDing - init(availableFunds:)

æŒ‰ç…§ TDD çš„æ­¥éª¤ï¼Œé¦–å…ˆè¦å†™ä¸€ä¸ªå¤±è´¥çš„ testï¼Œåœ¨ä¹‹å‰çš„ test ä¸‹é¢æ·»åŠ ä»£ç ï¼š

```swift
func testInitAvailableFunds_setsAvailableFunds() {
  // given
  let availableFunds = Decimal(100)
  
  // when
  let sut = CashRegister(availableFunds: availableFunds)
  
  // then
  XCTAssertEqual(sut.availableFunds, availableFunds)
}
```

è¿™ä¸ª test å’Œç¬¬ä¸€ä¸ªç›¸æ¯”æ›´åŠ å¤æ‚äº†ã€‚æ‰€ä»¥æŠŠå®ƒæ‹†åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼š**given**ã€**when** å’Œ **then** ã€‚ç”¨è¿™ç§æ–¹å¼è€ƒè™‘ UT å¾ˆæœ‰ç”¨ï¼š

- æä¾›ä¸€ä¸ªç¡®è®¤çš„æ¡ä»¶ã€‚
- å½“ä¸€ä¸ªç¡®è®¤çš„è¡Œä¸ºå‘ç”Ÿæ—¶ã€‚
- é‚£ä¹ˆä¸€ä¸ªé¢„æœŸçš„ç»“æœä¼šå‡ºç°ã€‚

ä»¥è¿™ä¸ª case ä¸º ğŸŒ°ï¼Œä½ æä¾›äº†ä¸€ä¸ª 100 çš„ <hl>availableFunds</hl>ï¼Œå½“ä½ ç”¨å®ƒåˆ›å»ºäº†ä¸€ä¸ª sut å®ä¾‹ï¼Œé‚£ä¹ˆä½ æœŸæœ› <hl>sut.availableFunds</hl> åº”å’Œ <hl>availableFunds</hl> ç›¸ç­‰ã€‚

sut( **system under test**)ï¼Œåœ¨ TDD ä¸­æ— è®ºä½ åœ¨æµ‹è¯•ä»€ä¹ˆéƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸ªåå­—ã€‚

ç”±äºè¿˜æ²¡æœ‰å£°æ˜ <hl>init(availableFunds:)</hl> ,ç›®å‰ä»£ç ä»æ— æ³•ç¼–è¯‘ã€‚ä¹‹å‰è¯´è¿‡ï¼Œç¼–è¯‘æŠ¥é”™è®¤ä¸ºæ˜¯æµ‹è¯•å¤±è´¥ï¼Œæ‰€ä»¥å·²ç»å®Œæˆäº†ç¬¬ä¸€æ­¥ã€‚

æ¥ä¸‹æ¥æ·»åŠ ä»£ç åˆ° <hl>CashRegister</hl>ï¼Œä½¿ç¼–è¯‘é€šè¿‡ï¼š

```
let availableFunds: Decimal

init(availableFunds: Decimal = 0) {
  self.availableFunds = availableFunds
}
```

ç°åœ¨ç‚¹å‡» **Play** æ‰§è¡Œæ‰€æœ‰çš„ tests ï¼Œä½ å°†åœ¨æ§åˆ¶å°çœ‹åˆ°ï¼š

```swift
Test Suite 'CashRegisterTests' started at 2021-11-18 17:27:34.168
Test Case '-[__lldb_expr_1.CashRegisterTests testInit_createsCashRegister]' started.
Test Case '-[__lldb_expr_1.CashRegisterTests testInit_createsCashRegister]' passed (0.003 seconds).
Test Case '-[__lldb_expr_1.CashRegisterTests testInitAvailableFunds_setAvailableFunds]' started.
Test Case '-[__lldb_expr_1.CashRegisterTests testInitAvailableFunds_setAvailableFunds]' passed (0.003 seconds).
Test Suite 'CashRegisterTests' passed at 2021-11-18 17:27:34.176.
	 Executed 2 tests, with 0 failures (0 unexpected) in 0.006 (0.008) seconds
```

è¿™é‡Œç°å®ä¸¤ä¸ª tests éƒ½é€šè¿‡äº†ï¼Œæ‰€ä»¥ä½ å®Œæˆäº†ç¬¬äºŒæ­¥ã€‚

æ¥ä¸‹æ¥å¼€å§‹æ¸…ç†ç”Ÿäº§ä»£ç å’Œæµ‹è¯•ä»£ç ï¼Œé¦–å…ˆçœ‹ä¸‹æµ‹è¯•ä»£ç ã€‚

<hl>testInit_createsCashRegister</hl>ç°åœ¨æ˜¯æ— æ•ˆçš„äº†ï¼Œå› ä¸ºå·²ç»æ²¡æœ‰ <hl>init()</hl> äº†ï¼Œè¿™ä¸ª test å®é™…ä¸Šæ˜¯è°ƒç”¨ <hl>init(availableFunds:)</hl> ï¼Œæ‰€ä»¥ç›´æ¥åˆ é™¤è¿™ä¸ª test ã€‚

åœ¨çœ‹ç”Ÿäº§ä»£ç ï¼Œæ·»åŠ è¿™ä¸ªé»˜è®¤å€¼ <hl>0</hl> æ˜¯å¦æœ‰å¿…è¦ï¼Ÿä¸ºäº†åŒæ—¶é€šè¿‡ <hl>testInit</hl> å’Œ <hl>testInitAvailableFunds</hl> æ˜¯å¿…è¦çš„ã€‚ä½†æ˜¯å¯¹äºè¿™ä¸ªç±»æ¥è¯´å‘¢ï¼Ÿ

è¿™é‡Œéœ€è¦è®¨è®ºä¸‹è®¾è®¡ï¼š

- å¦‚æœä½ æƒ³ç»§ç»­ä¿ç•™è¿™ä¸ªé»˜è®¤å€¼ï¼Œé‚£ä½ éœ€è¦æ·»åŠ ä¸€ä¸ª <hl>testInit_setsDefaultAvailableFunds</hl> ï¼Œæ¥æ£€æŸ¥é»˜è®¤å€¼çš„æƒ…å†µã€‚

- æˆ–è€…ä½ å¯ä»¥é€‰æ‹©åˆ é™¤é»˜è®¤å€¼ã€‚

åœ¨è¿™é‡Œï¼Œå‡è®¾ä¸éœ€è¦è¿™ä¸ªé»˜è®¤å€¼ï¼Œæ‰€ä»¥åˆ é™¤æ‰è¿™ä¸ªé»˜è®¤å€¼ã€‚ä½ çš„åˆå§‹åŒ–å‡½æ•°å˜æˆï¼š

```swift
init(availableFunds: Decimal) {
```

ç‚¹å‡» **Play** æ‰§è¡Œä½ å‰©ä¸‹çš„ test ï¼Œä½ ä¼šçœ‹åˆ°å®ƒé€šè¿‡äº†ã€‚

åœ¨é‡æ„å®Œ <hl>init(availableFunds:</hl> å <hl>testInitAvailableFunds</hl> ä»ç„¶æ˜¯é€šè¿‡çš„ï¼Œè¡¨ç¤ºä½ çš„æ”¹åŠ¨æ²¡ç”¨ç ´åç°æœ‰çš„ä»£ç è®¾è®¡ï¼Œä¿¡å¿ƒå€å¢ï¼Œè¿™æ˜¯ TDD åœ¨é‡æ„ä¸­å¸¦æ¥çš„ä¸€å¤§å¥½å¤„ã€‚

ç°åœ¨ä½ å®Œæˆäº†é‡æ„ï¼Œæ¥ä¸‹æ¥ä½ è¦å†æ¬¡é‡å¤è¿™äº›è¿‡ç¨‹ã€‚

##### TDDing addItem

#### 2.6 Challenge

#### 2.7 Key points









